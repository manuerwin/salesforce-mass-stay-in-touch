<apex:page standardController="Contact" recordSetVar="contacts" extensions="MSIT_AdjustEmailAndSend_ExCon">
<!-- 
	Copyright (C) 2014  Manu Erwin

	This program is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	This program is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with this program.  If not, see <http://www.gnu.org/licenses/>.

	Type:		Visualforce Page for Mass Stay In Touch Requests
	Purpose:	The user should be shown a page where they can adjust the text content of the email subject,
				the text content of the body of the Stay In Touch email, view the list of fields that will be
				displayed to the recipient, and adjust the text content of their email signature.

				They can optionally tick a checkbox to be bcc’d on one of the emails.
				They can optionally tick a checkbox to cause each email to be stored as an activity associated to the relevant Contact.
				Note: this checkbox should not be shown if a custom setting to always store activities is true.
				As standard List View functionality does not specifically restrict based on “Do Not Contact” Contact attributes,
				they should be shown text at the top of the page notifying them that Contacts who have indicated
				they do not wish to be contacted (Email Opt Out) have been excluded.
				If possible they should be shown the number of emails left that can be sent based on org governor limits.
				Note: if the limit has been exceeded, the page should only display a message to that effect,
				advising the user to check back later and/or contact their system administrator.
				
	Used By:	Custom Contact List Button
	History:	17-Apr-2014	Manu Erwin (Salesforce.com)    Created
-->

	<apex:sectionHeader id="sectionHeader" title="Mass Stay-in-Touch" subtitle="Confirmation" />

	<apex:form id="theForm" >
		<apex:pageBlock id="reviewAndConfirm" title="Review and Confirm" >

			<apex:pageMessages />

			<apex:pageBlockButtons id="pageButtons" >
				<apex:commandButton id="cancel" action="{!cancel}" value="Cancel" />
				<apex:commandButton id="send" action="{!sendEmail}" value="Send Email to all Contacts" />
			</apex:pageBlockButtons>
			<apex:pageBlockSection id="numberOfRecipients" collapsible="false" columns="1" >
				You currently have <b>{!numberOfTargetedContacts} recipient(s)</b> selected to receive this email.
				Note: Contacts without an email address and who have opted out of email have been excluded.
			</apex:pageBlockSection>

			<apex:pageBlockSection id="bccAndStoreActivityCheckboxes" collapsible="false" columns="2" >
				<apex:inputCheckbox id="bccMe" label="BCC me on one message" value="{!bccMe}" />
				<apex:inputCheckbox id="storeActivity" label="Store an activity for each message" value="{!storeActivity}" />
			</apex:pageBlockSection>

			<apex:pageBlockSection id="emailContent" collapsible="false" columns="1" >
				Review and edit the subject, body, and signature below. When satisfactory, click Send.

		        <apex:pageBlockSectionItem >
		            <apex:outputLabel value="Subject" for="emailSubject" />
		            <apex:outputPanel >
		                <div class="requiredInput">
		                    <div class="requiredBlock"></div>
							<apex:inputText id="emailSubject" required="true" value="{!emailSubject}" />
		                </div>
		            </apex:outputPanel>
		        </apex:pageBlockSectionItem>

Enter your greeting, for example, Dear or Hi. This will be followed by the Contacts first name, for example, "Hi John,"
		        <apex:pageBlockSectionItem >
		            <apex:outputLabel value="Greeting" for="emailGreeting" />
		            <apex:outputPanel >
		                <div class="requiredInput">
		                    <div class="requiredBlock"></div>
							<apex:inputTextarea id="emailGreeting" required="true" value="{!emailGreeting}" />
		                </div>
		            </apex:outputPanel>
		        </apex:pageBlockSectionItem>

		        <apex:pageBlockSectionItem >
		            <apex:outputLabel value="Stay In Touch Note" for="emailBody" />
		            <apex:outputPanel >
		                <div class="requiredInput">
		                    <div class="requiredBlock"></div>
							<apex:inputTextarea id="emailBody" required="true" value="{!emailBody}" />
		                </div>
		            </apex:outputPanel>
		        </apex:pageBlockSectionItem>

			</apex:pageBlockSection>

			<apex:pageBlockSection id="emailFields" collapsible="false" columns="2" >
				The following fields will be merged into the email following your note.
             
             <apex:outputText id="nameField" value="(Name)" />
				<apex:outputText id="titleField" value="(Title)" />

				<apex:outputText id="departmentField" value="(Department)" />
				<apex:outputText id="CompanyField" value="(Company)" />

				<apex:outputText id="mailingStreetField" value="(Mailing Street)" />
				<apex:outputText id="addressField" value="(Mailing City, Mailing State/Province, Mailing Zip/Postal Code)" />

				<apex:outputText id="mailingCountryField" value="(Mailing Country)" />
				<apex:outputText id="emailField" value="(Email)" />

				<apex:outputText id="phoneField" value="(Phone)" />
				<apex:outputText id="mobileField" value="(Mobile)" />

				<apex:outputText id="homePhoneField" value="(Home Phone)" />
				<apex:outputText id="faxField" value="(Fax)" />

				<apex:outputText id="assistantField" value="(Assistant)" />
				<apex:outputText id="asstPhoneField" value="(Asst. Phone)" />
			</apex:pageBlockSection>

			<apex:pageBlockSection id="emailSignatureSection" collapsible="false" columns="1" >
		        <apex:pageBlockSectionItem >
		            <apex:outputLabel value="Signature" for="emailSignature" />
		            <apex:outputPanel >
		                <div class="requiredInput">
		                    <div class="requiredBlock"></div>
							<apex:inputTextarea id="emailSignature" required="true" value="{!emailSignature}" />
		                </div>
		            </apex:outputPanel>
		        </apex:pageBlockSectionItem>

			</apex:pageBlockSection>

		</apex:pageBlock>
	</apex:form>
</apex:page>